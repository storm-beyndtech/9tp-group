"use strict";window.onload=function(){$.validator.addMethod("englishsonly",function(e,t){return this.optional(t)||/^[a-z ]+$/i.test(e)},"Only latin letters are allowed."),$.validator.addMethod("itivalidnumber",function(e,t){return console.log(iti.isValidNumber()),iti.isValidNumber()},"Invalid number."),$(".webinar-digital .contact-form form").each(function(){$(this).validate({errorClass:"has-error",validClass:"has-success",showErrors:function(e){e.attach&&Notify(uploadErrorMessage,notifyDelay),this.defaultShowErrors()},highlight:function(e,t,n){$(e).parent().addClass(t).removeClass(n)},unhighlight:function(e,t,n){$(e).parent().removeClass(t).addClass(n)},rules:{name:{required:!0,englishsonly:!0,maxlength:255},last_name:{required:!0,englishsonly:!0,maxlength:255},phone:{required:!0,itivalidnumber:!0},company:{required:!0,englishsonly:!0,maxlength:255},position:{required:!0,englishsonly:!0,maxlength:255},country:{required:!0},size:{required:!0},email:{required:{depends:function(){return $(this).val($.trim($(this).val())),!0}},email:!0,maxlength:255}},messages:{email:{email:"Please use your corporate email",required:!1},englishsonly:!1,phone:!1,country:!1,size:!1,company:!1,last_name:!1,name:!1,position:!1},submitHandler:function(a,e){var o=this;e.preventDefault();var s=document.querySelector(".webinar-digital .contact-form form .main-btn");s.disabled=!0,s.classList.add("button--loading");var t=new FormData(a),i=new XMLHttpRequest,n={submittedAt:(new Date).getTime(),fields:[{name:"firstname",value:t.get("name")},{name:"lastname",value:t.get("last_name")},{name:"email",value:t.get("email")},{name:"phone",value:t.get("phone")},{name:"company",value:t.get("company")},{name:"jobtitle",value:t.get("position")},{name:"numemployees",value:t.get("size")},{name:"country",value:t.get("country")}],context:{pageUri:"https://www.intellectsoft.net/l/44/webinar-digitalization-construction-2021",pageName:"Digital Transformation in Construction: Process Agility"}},r=JSON.stringify(n),l=document.querySelector(".webinar-digital .contact-form .success-message");document.querySelector(".webinar-digital .contact-form .form-header");i.open("POST","https://api.hsforms.com/submissions/v3/integration/submit/20037848/c7e131d2-2802-43ef-afc8-af0dc647a9ee"),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){window.dataLayer.push({event:"WebinarWebFormSubmit"}),a.classList.add("hidden"),l.classList.remove("hidden");var e=document.querySelector(".modal-video");if(s&&e){var t=function(){e.innerHTML="",e.style.display="none"};if(e){var n='<div class="container">\n                                <div class="modal-video__iframe-container">\n                                    <iframe class="modal-video__iframe" src="https://www.youtube.com/embed/'+e.dataset.videoid+'/rel=0&showinfo=0&autoplay=0&loop=0&egm=0&showsearch=0&controls=0&iv_load_policy=3" frameborder="0" allowfullscreen></iframe>\n                                </div>\n                            </div>';e.innerHTML=n,e.style.display="block"}e.addEventListener("click",function(e){t()}),$(document).keyup(function(e){27===e.keyCode&&t()})}}else if(4==i.readyState&&400==i.status){JSON.parse(i.response).errors.forEach(function(e){"INVALID_EMAIL"!=e.errorType&&"BLOCKED_EMAIL"!=e.errorType||o.showErrors({email:"Please use your corporate email"})}),console.log(JSON.parse(i.response).errors)}else(4==i.readyState&&403==i.status||4==i.readyState&&404==i.status)&&console.log(JSON.parse(i.response).errors);s.classList.remove("button--loading"),s.disabled=!1},i.send(r)}})});var a,o,s,i;a=document.getElementById("pined-form"),o=document.querySelector(".main-header"),s=document.querySelector(".main-content"),i=a.getBoundingClientRect(),window.addEventListener("scroll",function(e){var t=o.getBoundingClientRect(),n=s.getBoundingClientRect();t.top+50<0&&0<n.bottom-i.height-130?a.classList.add("fixed-form"):a.classList.remove("fixed-form"),t.top+50&&n.bottom-i.height-130<0?a.classList.add("stop-form"):a.classList.remove("stop-form")});var r,l;r=new Date(2021,6,7,3,0,0).getTime(),l=setInterval(function(){var e=new Date;e.setTime(e.getTime()+60*e.getTimezoneOffset()*1e3-18e6);var t=r-e.getTime(),n=Math.floor(t/864e5),a=Math.floor(t%864e5/36e5),o=Math.floor(t%36e5/6e4),s=Math.floor(t%6e4/1e3);t<0?clearInterval(l):document.getElementById("countdown").innerHTML='<div class="timer-block">'+n+'<span>days</span></div> :\n                <div class="timer-block">'+a+'<span>hours</span></div> :\n                <div class="timer-block">'+o+'<span>minutes</span></div> :\n                <div class="timer-block">'+s+"<span>seconds</span></div>"},1e3)},function(n){function a(){n(window).width()<768?(n(".footer__menu .has-dropdown").on("click",function(){n(this).toggleClass("arrow-down"),n(".arrow-down .toggle-menu").slideToggle("slow")}),n(".footer__menu .has-dropdown").on("click",function(e){e.preventDefault();var t=n(this).find(".sub-menu");t.hasClass("show")?t.removeClass("show"):(t.parent().find(".sub-menu").removeClass("show"),t.toggleClass("show"))})):(n(".footer__menu .has-dropdown").off("click"),n(".footer__menu .has-dropdown").off("click"))}function o(e){e.value.trim()&&(iti.isValidNumber()?(e.parentElement.parentElement.classList.remove("has-error"),e.parentElement.classList.add("has-success"),e.parentElement.setAttribute("style","background-image: url(img/icons/has-success.svg) !important"),e.parentElement.removeAttribute("id")):(e.parentElement.parentElement.classList.add("has-error"),e.parentElement.classList.remove("has-success"),e.parentElement.setAttribute("style","background-image: none !important"),e.parentElement.setAttribute("id","phone-no-success")))}n(document).ready(function(){var t=document.querySelector("#phone"),e=document.querySelector("#country");window.iti=window.intlTelInput(t,{utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/8.4.6/js/utils.js"}),e.value=iti.getSelectedCountryData().name.replace(/\s*\(.*?\)\s*/g,""),t.addEventListener("countrychange",function(){e.value=iti.getSelectedCountryData().name.replace(/\s*\(.*?\)\s*/g,""),o(t)}),t.addEventListener("input",function(e){o(t)}),n("form :input").focus(function(){n("label[for='"+this.id+"']").addClass("selected")}).blur(function(){n("label").removeClass("selected")}),a()}),n(window).resize(function(){a()})}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsid2luZG93Iiwib25sb2FkIiwiJCIsInZhbGlkYXRvciIsImFkZE1ldGhvZCIsInZhbHVlIiwiZWxlbWVudCIsInRoaXMiLCJvcHRpb25hbCIsInRlc3QiLCJjb25zb2xlIiwibG9nIiwiaXRpIiwiaXNWYWxpZE51bWJlciIsImVhY2giLCJ2YWxpZGF0ZSIsImVycm9yQ2xhc3MiLCJ2YWxpZENsYXNzIiwic2hvd0Vycm9ycyIsImVycm9yTWFwIiwiTm90aWZ5IiwidXBsb2FkRXJyb3JNZXNzYWdlIiwibm90aWZ5RGVsYXkiLCJkZWZhdWx0U2hvd0Vycm9ycyIsImhpZ2hsaWdodCIsImVsZW0iLCJwYXJlbnQiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwidW5oaWdobGlnaHQiLCJydWxlcyIsIm5hbWUiLCJyZXF1aXJlZCIsImVuZ2xpc2hzb25seSIsIm1heGxlbmd0aCIsImxhc3RfbmFtZSIsInBob25lIiwiaXRpdmFsaWRudW1iZXIiLCJjb21wYW55IiwicG9zaXRpb24iLCJjb3VudHJ5Iiwic2l6ZSIsImVtYWlsIiwiZGVwZW5kcyIsInZhbCIsInRyaW0iLCJtZXNzYWdlcyIsInN1Ym1pdEhhbmRsZXIiLCJmb3JtIiwiZXZlbnQiLCJ0dGhpcyIsInByZXZlbnREZWZhdWx0IiwiYnV0dG9uTW9kYWwiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJkaXNhYmxlZCIsImNsYXNzTGlzdCIsImFkZCIsInJvd0RhdGEiLCJGb3JtRGF0YSIsInhociIsIlhNTEh0dHBSZXF1ZXN0IiwiZGF0YSIsInN1Ym1pdHRlZEF0IiwiRGF0ZSIsImdldFRpbWUiLCJmaWVsZHMiLCJnZXQiLCJjb250ZXh0IiwicGFnZVVyaSIsInBhZ2VOYW1lIiwiZmluYWxfZGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdWNjZXNzTWVzc2FnZSIsIm9wZW4iLCJzZXRSZXF1ZXN0SGVhZGVyIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsImRhdGFMYXllciIsInB1c2giLCJyZW1vdmUiLCJtb2RhbFdpbmRvdyIsImNsb3NlTW9kYWwiLCJpbm5lckhUTUwiLCJzdHlsZSIsImRpc3BsYXkiLCJpZnJhbWUiLCJkYXRhc2V0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJrZXl1cCIsImtleUNvZGUiLCJwYXJzZSIsInJlc3BvbnNlIiwiZXJyb3JzIiwiZm9yRWFjaCIsImVudHJ5IiwiZXJyb3JUeXBlIiwic2VuZCIsIm1haW5IZWFkZXIiLCJtYWluQ29udGVudCIsImZvcm1SZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJtYWluSGVhZGVyUmVjdCIsIm1haW5Db250ZW50UmVjdCIsInRvcCIsImJvdHRvbSIsImhlaWdodCIsImNvdW50RG93bkRhdGUiLCJ4Iiwic2V0SW50ZXJ2YWwiLCJub3ciLCJzZXRUaW1lIiwiZ2V0VGltZXpvbmVPZmZzZXQiLCJkaXN0YW5jZSIsImRheXMiLCJNYXRoIiwiZmxvb3IiLCJob3VycyIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwiY2xlYXJJbnRlcnZhbCIsIm9uUmVzaXplIiwid2lkdGgiLCJvbiIsInRvZ2dsZUNsYXNzIiwic2xpZGVUb2dnbGUiLCIkdGhpcyIsImZpbmQiLCJoYXNDbGFzcyIsIm9mZiIsInZhbGlkYXRlSW5wdXQiLCJpbnB1dCIsInBhcmVudEVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJyZWFkeSIsImludGxUZWxJbnB1dCIsInV0aWxzU2NyaXB0IiwiZ2V0U2VsZWN0ZWRDb3VudHJ5RGF0YSIsInJlcGxhY2UiLCJmb2N1cyIsImlkIiwiYmx1ciIsInJlc2l6ZSIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkFBQUEsYUFFQUEsT0FBQUMsT0FBQSxXQUNBQyxFQUFBQyxVQUFBQyxVQUFBLGVBQUEsU0FBQUMsRUFBQUMsR0FDQSxPQUFBQyxLQUFBQyxTQUFBRixJQUFBLGFBQUFHLEtBQUFKLElBQ0EsbUNBRUFI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LElBQUEsU0FDQW5JLEVBQUEsK0JBQUFtSSxJQUFBLFVBNEJBLFNBQUFDLEVBQUFDLEdBQ0FBLEVBQUFsSSxNQUFBd0MsU0FDQWpDLElBQUFDLGlCQUNBMEgsRUFBQUMsY0FBQUEsY0FBQWhGLFVBQUEwQixPQUFBLGFBQ0FxRCxFQUFBQyxjQUFBaEYsVUFBQUMsSUFBQSxlQUNBOEUsRUFBQUMsY0FBQUMsYUFBQSxRQUFBLCtEQUNBRixFQUFBQyxjQUFBRSxnQkFBQSxRQUVBSCxFQUFBQyxjQUFBQSxjQUFBaEYsVUFBQUMsSUFBQSxhQUNBOEUsRUFBQUMsY0FBQWhGLFVBQUEwQixPQUFBLGVBQ0FxRCxFQUFBQyxjQUFBQyxhQUFBLFFBQUEscUNBQ0FGLEVBQUFDLGNBQUFDLGFBQUEsS0FBQSxzQkFuQ0F2SSxFQUFBbUQsVUFBQXNGLE1BQUEsV0FDQSxJQUFBSixFQUFBbEYsU0FBQUMsY0FBQSxVQUNBZCxFQUFBYSxTQUFBQyxjQUFBLFlBQ0F0RCxPQUFBWSxJQUFBWixPQUFBNEksYUFBQUwsRUFBQSxDQUNBTSxZQUFBLDRFQUVBckcsRUFBQW5DLE1BQUFPLElBQUFrSSx5QkFBQS9HLEtBQUFnSCxRQUFBLGlCQUFBLElBQ0FSLEVBQUE3QyxpQkFBQSxnQkFBQSxXQUNBbEQsRUFBQW5DLE1BQUFPLElBQUFrSSx5QkFBQS9HLEtBQUFnSCxRQUFBLGlCQUFBLElBQ0FULEVBQUFDLEtBRUFBLEVBQUE3QyxpQkFBQSxRQUFBLFNBQUFDLEdBQ0EyQyxFQUFBQyxLQUdBckksRUFBQSxlQUFBOEksTUFBQSxXQUNBOUksRUFBQSxjQUFBSyxLQUFBMEksR0FBQSxNQUFBdEgsU0FBQSxjQUNBdUgsS0FBQSxXQUNBaEosRUFBQSxTQUFBMEIsWUFBQSxjQUdBaUcsTUFtQkEzSCxFQUFBRixRQUFBbUosT0FBQSxXQUNBdEIsTUFuRUEsQ0FxRUF1QiIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICQudmFsaWRhdG9yLmFkZE1ldGhvZChcImVuZ2xpc2hzb25seVwiLCBmdW5jdGlvbiAodmFsdWUsIGVsZW1lbnQpIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25hbChlbGVtZW50KSB8fCAvXlthLXogXSskL2kudGVzdCh2YWx1ZSk7XG4gIH0sIFwiT25seSBsYXRpbiBsZXR0ZXJzIGFyZSBhbGxvd2VkLlwiKTtcblxuICAkLnZhbGlkYXRvci5hZGRNZXRob2QoXCJpdGl2YWxpZG51bWJlclwiLCBmdW5jdGlvbiAodmFsdWUsIGVsZW1lbnQpIHtcbiAgICBjb25zb2xlLmxvZyhpdGkuaXNWYWxpZE51bWJlcigpKTtcbiAgICByZXR1cm4gaXRpLmlzVmFsaWROdW1iZXIoKTtcbiAgfSwgXCJJbnZhbGlkIG51bWJlci5cIik7XG5cbiAgJCgnLndlYmluYXItZGlnaXRhbCAuY29udGFjdC1mb3JtIGZvcm0nKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAkKHRoaXMpLnZhbGlkYXRlKHtcbiAgICAgIGVycm9yQ2xhc3M6ICdoYXMtZXJyb3InLFxuICAgICAgdmFsaWRDbGFzczogJ2hhcy1zdWNjZXNzJyxcbiAgICAgIHNob3dFcnJvcnM6IGZ1bmN0aW9uIHNob3dFcnJvcnMoZXJyb3JNYXApIHtcbiAgICAgICAgaWYgKGVycm9yTWFwWydhdHRhY2gnXSkgTm90aWZ5KHVwbG9hZEVycm9yTWVzc2FnZSwgbm90aWZ5RGVsYXkpO1xuICAgICAgICB0aGlzLmRlZmF1bHRTaG93RXJyb3JzKCk7XG4gICAgICB9LFxuICAgICAgaGlnaGxpZ2h0OiBmdW5jdGlvbiBoaWdobGlnaHQoZWxlbSwgZXJyb3JDbGFzcywgdmFsaWRDbGFzcykge1xuICAgICAgICAkKGVsZW0pLnBhcmVudCgpLmFkZENsYXNzKGVycm9yQ2xhc3MpLnJlbW92ZUNsYXNzKHZhbGlkQ2xhc3MpO1xuICAgICAgfSxcbiAgICAgIHVuaGlnaGxpZ2h0OiBmdW5jdGlvbiB1bmhpZ2hsaWdodChlbGVtLCBlcnJvckNsYXNzLCB2YWxpZENsYXNzKSB7XG4gICAgICAgICQoZWxlbSkucGFyZW50KCkucmVtb3ZlQ2xhc3MoZXJyb3JDbGFzcykuYWRkQ2xhc3ModmFsaWRDbGFzcyk7XG4gICAgICB9LFxuICAgICAgcnVsZXM6IHtcbiAgICAgICAgbmFtZToge1xuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGVuZ2xpc2hzb25seTogdHJ1ZSxcbiAgICAgICAgICBtYXhsZW5ndGg6IDI1NVxuICAgICAgICB9LFxuICAgICAgICBsYXN0X25hbWU6IHtcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBlbmdsaXNoc29ubHk6IHRydWUsXG4gICAgICAgICAgbWF4bGVuZ3RoOiAyNTVcbiAgICAgICAgfSxcbiAgICAgICAgcGhvbmU6IHtcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBpdGl2YWxpZG51bWJlcjogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBjb21wYW55OiB7XG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZW5nbGlzaHNvbmx5OiB0cnVlLFxuICAgICAgICAgIG1heGxlbmd0aDogMjU1XG4gICAgICAgIH0sXG4gICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZW5nbGlzaHNvbmx5OiB0cnVlLFxuICAgICAgICAgIG1heGxlbmd0aDogMjU1XG4gICAgICAgIH0sXG4gICAgICAgIGNvdW50cnk6IHtcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBzaXplOiB7XG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICByZXF1aXJlZDoge1xuICAgICAgICAgICAgZGVwZW5kczogZnVuY3Rpb24gZGVwZW5kcygpIHtcbiAgICAgICAgICAgICAgJCh0aGlzKS52YWwoJC50cmltKCQodGhpcykudmFsKCkpKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICBtYXhsZW5ndGg6IDI1NVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgbWVzc2FnZXM6IHtcbiAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICBlbWFpbDogJ1BsZWFzZSB1c2UgeW91ciBjb3Jwb3JhdGUgZW1haWwnLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICBlbmdsaXNoc29ubHk6IGZhbHNlLFxuICAgICAgICBwaG9uZTogZmFsc2UsXG4gICAgICAgIGNvdW50cnk6IGZhbHNlLFxuICAgICAgICBzaXplOiBmYWxzZSxcbiAgICAgICAgY29tcGFueTogZmFsc2UsXG4gICAgICAgIGxhc3RfbmFtZTogZmFsc2UsXG4gICAgICAgIG5hbWU6IGZhbHNlLFxuICAgICAgICBwb3NpdGlvbjogZmFsc2VcbiAgICAgIH0sXG4gICAgICBzdWJtaXRIYW5kbGVyOiBmdW5jdGlvbiBzdWJtaXRIYW5kbGVyKGZvcm0sIGV2ZW50KSB7XG4gICAgICAgIHZhciB0dGhpcyA9IHRoaXM7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHZhciBidXR0b25Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53ZWJpbmFyLWRpZ2l0YWwgLmNvbnRhY3QtZm9ybSBmb3JtIC5tYWluLWJ0bicpO1xuICAgICAgICBidXR0b25Nb2RhbC5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIGJ1dHRvbk1vZGFsLmNsYXNzTGlzdC5hZGQoXCJidXR0b24tLWxvYWRpbmdcIik7XG4gICAgICAgIHZhciByb3dEYXRhID0gbmV3IEZvcm1EYXRhKGZvcm0pO1xuICAgICAgICAvLyBDcmVhdGUgdGhlIG5ldyByZXF1ZXN0XG4gICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgLy8gRXhhbXBsZSByZXF1ZXN0IEpTT046XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgIFwic3VibWl0dGVkQXRcIjogbmV3IERhdGUoKS5nZXRUaW1lKCksXG4gICAgICAgICAgXCJmaWVsZHNcIjogW3tcbiAgICAgICAgICAgIFwibmFtZVwiOiBcImZpcnN0bmFtZVwiLFxuICAgICAgICAgICAgXCJ2YWx1ZVwiOiByb3dEYXRhLmdldCgnbmFtZScpXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgXCJuYW1lXCI6IFwibGFzdG5hbWVcIixcbiAgICAgICAgICAgIFwidmFsdWVcIjogcm93RGF0YS5nZXQoJ2xhc3RfbmFtZScpXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgXCJuYW1lXCI6IFwiZW1haWxcIixcbiAgICAgICAgICAgIFwidmFsdWVcIjogcm93RGF0YS5nZXQoJ2VtYWlsJylcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBcIm5hbWVcIjogXCJwaG9uZVwiLFxuICAgICAgICAgICAgXCJ2YWx1ZVwiOiByb3dEYXRhLmdldCgncGhvbmUnKVxuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIFwibmFtZVwiOiBcImNvbXBhbnlcIixcbiAgICAgICAgICAgIFwidmFsdWVcIjogcm93RGF0YS5nZXQoJ2NvbXBhbnknKVxuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIFwibmFtZVwiOiBcImpvYnRpdGxlXCIsXG4gICAgICAgICAgICBcInZhbHVlXCI6IHJvd0RhdGEuZ2V0KCdwb3NpdGlvbicpXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgXCJuYW1lXCI6IFwibnVtZW1wbG95ZWVzXCIsXG4gICAgICAgICAgICBcInZhbHVlXCI6IHJvd0RhdGEuZ2V0KCdzaXplJylcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBcIm5hbWVcIjogXCJjb3VudHJ5XCIsXG4gICAgICAgICAgICBcInZhbHVlXCI6IHJvd0RhdGEuZ2V0KCdjb3VudHJ5JylcbiAgICAgICAgICB9XSxcbiAgICAgICAgICBcImNvbnRleHRcIjoge1xuICAgICAgICAgICAgXCJwYWdlVXJpXCI6IFwiaHR0cHM6Ly93d3cuaW50ZWxsZWN0c29mdC5uZXQvbC80NC93ZWJpbmFyLWRpZ2l0YWxpemF0aW9uLWNvbnN0cnVjdGlvbi0yMDIxXCIsXG4gICAgICAgICAgICBcInBhZ2VOYW1lXCI6IFwiRGlnaXRhbCBUcmFuc2Zvcm1hdGlvbiBpbiBDb25zdHJ1Y3Rpb246IFByb2Nlc3MgQWdpbGl0eVwiXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB2YXIgZmluYWxfZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICB2YXIgc3VjY2Vzc01lc3NhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud2ViaW5hci1kaWdpdGFsIC5jb250YWN0LWZvcm0gLnN1Y2Nlc3MtbWVzc2FnZScpO1xuICAgICAgICB2YXIgc3VjY2Vzc0hlYWRpbmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud2ViaW5hci1kaWdpdGFsIC5jb250YWN0LWZvcm0gLmZvcm0taGVhZGVyJyk7XG4gICAgICAgIHhoci5vcGVuKCdQT1NUJywgJ2h0dHBzOi8vYXBpLmhzZm9ybXMuY29tL3N1Ym1pc3Npb25zL3YzL2ludGVncmF0aW9uL3N1Ym1pdC8yMDAzNzg0OC9jN2UxMzFkMi0yODAyLTQzZWYtYWZjOC1hZjBkYzY0N2E5ZWUnKTtcbiAgICAgICAgLy8gU2V0cyB0aGUgdmFsdWUgb2YgdGhlICdDb250ZW50LVR5cGUnIEhUVFAgcmVxdWVzdCBoZWFkZXJzIHRvICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT0gNCAmJiB4aHIuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgLy8gUmV0dXJucyBhIDIwMCByZXNwb25zZSBpZiB0aGUgc3VibWlzc2lvbiBpcyBzdWNjZXNzZnVsLlxuICAgICAgICAgICAgd2luZG93LmRhdGFMYXllci5wdXNoKHsgJ2V2ZW50JzogJ1dlYmluYXJXZWJGb3JtU3VibWl0JyB9KTtcbiAgICAgICAgICAgIGZvcm0uY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgICAgICBzdWNjZXNzTWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcblxuICAgICAgICAgICAgdmFyIG1vZGFsV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLXZpZGVvJyk7XG4gICAgICAgICAgICBpZiAoYnV0dG9uTW9kYWwgJiYgbW9kYWxXaW5kb3cpIHtcbiAgICAgICAgICAgICAgdmFyIGNsb3NlTW9kYWwgPSBmdW5jdGlvbiBjbG9zZU1vZGFsKCkge1xuICAgICAgICAgICAgICAgIG1vZGFsV2luZG93LmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgICAgIG1vZGFsV2luZG93LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgaWYgKG1vZGFsV2luZG93KSB7XG4gICAgICAgICAgICAgICAgdmFyIHZpZGVvSWQgPSBtb2RhbFdpbmRvdy5kYXRhc2V0Wyd2aWRlb2lkJ107XG4gICAgICAgICAgICAgICAgdmFyIGlmcmFtZSA9IFwiPGRpdiBjbGFzcz1cXFwiY29udGFpbmVyXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcIm1vZGFsLXZpZGVvX19pZnJhbWUtY29udGFpbmVyXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aWZyYW1lIGNsYXNzPVxcXCJtb2RhbC12aWRlb19faWZyYW1lXFxcIiBzcmM9XFxcImh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2VtYmVkL1wiICsgdmlkZW9JZCArIFwiL3JlbD0wJnNob3dpbmZvPTAmYXV0b3BsYXk9MCZsb29wPTAmZWdtPTAmc2hvd3NlYXJjaD0wJmNvbnRyb2xzPTAmaXZfbG9hZF9wb2xpY3k9M1xcXCIgZnJhbWVib3JkZXI9XFxcIjBcXFwiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cIjtcbiAgICAgICAgICAgICAgICBtb2RhbFdpbmRvdy5pbm5lckhUTUwgPSBpZnJhbWU7XG4gICAgICAgICAgICAgICAgbW9kYWxXaW5kb3cuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBtb2RhbFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgY2xvc2VNb2RhbCgpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgJChkb2N1bWVudCkua2V5dXAoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAyNykge1xuICAgICAgICAgICAgICAgICAgY2xvc2VNb2RhbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmICh4aHIucmVhZHlTdGF0ZSA9PSA0ICYmIHhoci5zdGF0dXMgPT0gNDAwKSB7XG4gICAgICAgICAgICB2YXIgZXJyb3JzID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2UpLmVycm9yczsgLy8gUmV0dXJucyBhIDQwMCBlcnJvciB0aGUgc3VibWlzc2lvbiBpcyByZWplY3RlZC5cbiAgICAgICAgICAgIGVycm9ycy5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICAgICAgICBpZiAoZW50cnkuZXJyb3JUeXBlID09IFwiSU5WQUxJRF9FTUFJTFwiIHx8IGVudHJ5LmVycm9yVHlwZSA9PSBcIkJMT0NLRURfRU1BSUxcIikge1xuICAgICAgICAgICAgICAgIHR0aGlzLnNob3dFcnJvcnMoeyAnZW1haWwnOiAnUGxlYXNlIHVzZSB5b3VyIGNvcnBvcmF0ZSBlbWFpbCcgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5wYXJzZSh4aHIucmVzcG9uc2UpLmVycm9ycyk7XG4gICAgICAgICAgfSBlbHNlIGlmICh4aHIucmVhZHlTdGF0ZSA9PSA0ICYmIHhoci5zdGF0dXMgPT0gNDAzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnBhcnNlKHhoci5yZXNwb25zZSkuZXJyb3JzKTsgLy8gUmV0dXJucyBhIDQwMyBlcnJvciBpZiB0aGUgcG9ydGFsIGlzbid0IGFsbG93ZWQgdG8gcG9zdCBzdWJtaXNzaW9ucy5cbiAgICAgICAgICB9IGVsc2UgaWYgKHhoci5yZWFkeVN0YXRlID09IDQgJiYgeGhyLnN0YXR1cyA9PSA0MDQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlKS5lcnJvcnMpOyAvL1JldHVybnMgYSA0MDQgZXJyb3IgaWYgdGhlIGZvcm1HdWlkIGlzbid0IGZvdW5kXG4gICAgICAgICAgfVxuICAgICAgICAgIGJ1dHRvbk1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJidXR0b24tLWxvYWRpbmdcIik7XG4gICAgICAgICAgYnV0dG9uTW9kYWwuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gU2VuZHMgdGhlIHJlcXVlc3RcbiAgICAgICAgeGhyLnNlbmQoZmluYWxfZGF0YSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIHZhciBwaW5uZWRGb3JtID0gZnVuY3Rpb24gcGlubmVkRm9ybSgpIHtcbiAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwaW5lZC1mb3JtJyk7XG4gICAgdmFyIG1haW5IZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbi1oZWFkZXInKTtcbiAgICB2YXIgbWFpbkNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbi1jb250ZW50Jyk7XG4gICAgdmFyIGZvcm1SZWN0ID0gZm9ybS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIG1haW5IZWFkZXJSZWN0ID0gbWFpbkhlYWRlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIHZhciBtYWluQ29udGVudFJlY3QgPSBtYWluQ29udGVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIGlmIChtYWluSGVhZGVyUmVjdC50b3AgKyA1MCA8IDAgJiYgbWFpbkNvbnRlbnRSZWN0LmJvdHRvbSAtIGZvcm1SZWN0LmhlaWdodCAtIDEzMCA+IDApIHtcbiAgICAgICAgZm9ybS5jbGFzc0xpc3QuYWRkKCdmaXhlZC1mb3JtJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpeGVkLWZvcm0nKTtcbiAgICAgIH1cbiAgICAgIGlmIChtYWluSGVhZGVyUmVjdC50b3AgKyA1MCAmJiBtYWluQ29udGVudFJlY3QuYm90dG9tIC0gZm9ybVJlY3QuaGVpZ2h0IC0gMTMwIDwgMCkge1xuICAgICAgICBmb3JtLmNsYXNzTGlzdC5hZGQoJ3N0b3AtZm9ybScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9ybS5jbGFzc0xpc3QucmVtb3ZlKCdzdG9wLWZvcm0nKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBwaW5uZWRGb3JtKCk7XG5cbiAgdmFyIGNvdW50RG93biA9IGZ1bmN0aW9uIGNvdW50RG93bigpIHtcbiAgICB2YXIgY291bnREb3duRGF0ZSA9IG5ldyBEYXRlKDIwMjEsIDYsIDcsIDMsIDAsIDApLmdldFRpbWUoKTtcblxuICAgIHZhciB4ID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgIG5vdy5zZXRUaW1lKG5vdy5nZXRUaW1lKCkgKyBub3cuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwICogMTAwMCAtIDUgKiAzNjAwICogMTAwMCk7XG5cbiAgICAgIHZhciBkaXN0YW5jZSA9IGNvdW50RG93bkRhdGUgLSBub3cuZ2V0VGltZSgpO1xuXG4gICAgICB2YXIgZGF5cyA9IE1hdGguZmxvb3IoZGlzdGFuY2UgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuICAgICAgdmFyIGhvdXJzID0gTWF0aC5mbG9vcihkaXN0YW5jZSAlICgxMDAwICogNjAgKiA2MCAqIDI0KSAvICgxMDAwICogNjAgKiA2MCkpO1xuICAgICAgdmFyIG1pbnV0ZXMgPSBNYXRoLmZsb29yKGRpc3RhbmNlICUgKDEwMDAgKiA2MCAqIDYwKSAvICgxMDAwICogNjApKTtcbiAgICAgIHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcihkaXN0YW5jZSAlICgxMDAwICogNjApIC8gMTAwMCk7XG4gICAgICBpZiAoZGlzdGFuY2UgPCAwKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoeCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnRkb3duJykuaW5uZXJIVE1MID0gXCI8ZGl2IGNsYXNzPVxcXCJ0aW1lci1ibG9ja1xcXCI+XCIgKyBkYXlzICsgXCI8c3Bhbj5kYXlzPC9zcGFuPjwvZGl2PiA6XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInRpbWVyLWJsb2NrXFxcIj5cIiArIGhvdXJzICsgXCI8c3Bhbj5ob3Vyczwvc3Bhbj48L2Rpdj4gOlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ0aW1lci1ibG9ja1xcXCI+XCIgKyBtaW51dGVzICsgXCI8c3Bhbj5taW51dGVzPC9zcGFuPjwvZGl2PiA6XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInRpbWVyLWJsb2NrXFxcIj5cIiArIHNlY29uZHMgKyBcIjxzcGFuPnNlY29uZHM8L3NwYW4+PC9kaXY+XCI7XG4gICAgICB9XG4gICAgfSwgMTAwMCk7XG4gIH07XG4gIGNvdW50RG93bigpO1xufTtcblxuO1xuKGZ1bmN0aW9uICgkKSB7XG4gIGZ1bmN0aW9uIG9uUmVzaXplKCkge1xuICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDc2OCkge1xuICAgICAgJCgnLmZvb3Rlcl9fbWVudSAuaGFzLWRyb3Bkb3duJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdhcnJvdy1kb3duJyk7XG4gICAgICAgICQoJy5hcnJvdy1kb3duIC50b2dnbGUtbWVudScpLnNsaWRlVG9nZ2xlKCdzbG93Jyk7XG4gICAgICB9KTtcblxuICAgICAgJCgnLmZvb3Rlcl9fbWVudSAuaGFzLWRyb3Bkb3duJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIHZhciAkdGhpcyA9ICQodGhpcykuZmluZCgnLnN1Yi1tZW51Jyk7XG5cbiAgICAgICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdzaG93JykpIHtcbiAgICAgICAgICAkdGhpcy5yZW1vdmVDbGFzcygnc2hvdycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICR0aGlzLnBhcmVudCgpLmZpbmQoJy5zdWItbWVudScpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgICAgICAgJHRoaXMudG9nZ2xlQ2xhc3MoJ3Nob3cnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJy5mb290ZXJfX21lbnUgLmhhcy1kcm9wZG93bicpLm9mZignY2xpY2snKTtcbiAgICAgICQoJy5mb290ZXJfX21lbnUgLmhhcy1kcm9wZG93bicpLm9mZignY2xpY2snKTtcbiAgICB9XG4gIH1cblxuICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaG9uZVwiKTtcbiAgICB2YXIgY291bnRyeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY291bnRyeVwiKTtcbiAgICB3aW5kb3cuaXRpID0gd2luZG93LmludGxUZWxJbnB1dChpbnB1dCwge1xuICAgICAgdXRpbHNTY3JpcHQ6IFwiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvaW50bC10ZWwtaW5wdXQvOC40LjYvanMvdXRpbHMuanNcIlxuICAgIH0pO1xuICAgIGNvdW50cnkudmFsdWUgPSBpdGkuZ2V0U2VsZWN0ZWRDb3VudHJ5RGF0YSgpLm5hbWUucmVwbGFjZSgvXFxzKlxcKC4qP1xcKVxccyovZywgJycpO1xuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjb3VudHJ5Y2hhbmdlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvdW50cnkudmFsdWUgPSBpdGkuZ2V0U2VsZWN0ZWRDb3VudHJ5RGF0YSgpLm5hbWUucmVwbGFjZSgvXFxzKlxcKC4qP1xcKVxccyovZywgJycpO1xuICAgICAgdmFsaWRhdGVJbnB1dChpbnB1dCk7XG4gICAgfSk7XG4gICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFsaWRhdGVJbnB1dChpbnB1dCk7XG4gICAgfSk7XG5cbiAgICAkKFwiZm9ybSA6aW5wdXRcIikuZm9jdXMoZnVuY3Rpb24gKCkge1xuICAgICAgJChcImxhYmVsW2Zvcj0nXCIgKyB0aGlzLmlkICsgXCInXVwiKS5hZGRDbGFzcyhcInNlbGVjdGVkXCIpO1xuICAgIH0pLmJsdXIoZnVuY3Rpb24gKCkge1xuICAgICAgJChcImxhYmVsXCIpLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWRcIik7XG4gICAgfSk7XG5cbiAgICBvblJlc2l6ZSgpO1xuICB9KTtcblxuICBmdW5jdGlvbiB2YWxpZGF0ZUlucHV0KGlucHV0KSB7XG4gICAgaWYgKGlucHV0LnZhbHVlLnRyaW0oKSkge1xuICAgICAgaWYgKGl0aS5pc1ZhbGlkTnVtYmVyKCkpIHtcbiAgICAgICAgaW5wdXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJoYXMtZXJyb3JcIik7XG4gICAgICAgIGlucHV0LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImhhcy1zdWNjZXNzXCIpO1xuICAgICAgICBpbnB1dC5wYXJlbnRFbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnYmFja2dyb3VuZC1pbWFnZTogdXJsKGltZy9pY29ucy9oYXMtc3VjY2Vzcy5zdmcpICFpbXBvcnRhbnQnKTtcbiAgICAgICAgaW5wdXQucGFyZW50RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2lkJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnB1dC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImhhcy1lcnJvclwiKTtcbiAgICAgICAgaW5wdXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiaGFzLXN1Y2Nlc3NcIik7XG4gICAgICAgIGlucHV0LnBhcmVudEVsZW1lbnQuc2V0QXR0cmlidXRlKCdzdHlsZScsICdiYWNrZ3JvdW5kLWltYWdlOiBub25lICFpbXBvcnRhbnQnKTtcbiAgICAgICAgaW5wdXQucGFyZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3Bob25lLW5vLXN1Y2Nlc3MnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uICgpIHtcbiAgICBvblJlc2l6ZSgpO1xuICB9KTtcbn0pKGpRdWVyeSk7Il19
